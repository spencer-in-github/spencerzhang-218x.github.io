select(name, label),
by = c("name" = "name")
) %>%
select(-name) %>%
separate(
label,
into = c(NA, NA, "means"),
sep = "!!"
) %>%
pivot_wider(
means,
names_from = county,
values_from = estimate
) %>%
filter(!is.na(means)) %>%
mutate(
total = sum(starts_with("0"))
)
View(bay_means)
bay_means <-
getCensus(
name = "acs/acs5",
vintage = 2019,
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = "group(B08105A)"
) %>%
select(!c(GEO_ID,state,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_5yr %>%
select(name, label),
by = c("name" = "name")
) %>%
select(-name) %>%
separate(
label,
into = c(NA, NA, "means"),
sep = "!!"
) %>%
pivot_wider(
means,
names_from = county,
values_from = estimate
) %>%
filter(!is.na(means)) %>%
mutate(
total = rowSums(.[,2:])
)
bay_means <-
getCensus(
name = "acs/acs5",
vintage = 2019,
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = "group(B08105A)"
) %>%
select(!c(GEO_ID,state,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_5yr %>%
select(name, label),
by = c("name" = "name")
) %>%
select(-name) %>%
separate(
label,
into = c(NA, NA, "means"),
sep = "!!"
) %>%
pivot_wider(
means,
names_from = county,
values_from = estimate
) %>%
filter(!is.na(means)) %>%
mutate(
total = rowSums(.[,2:10])
)
View(bay_means)
bay_means <-
getCensus(
name = "acs/acs5",
vintage = 2019,
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = "group(B08105A)"
) %>%
select(!c(GEO_ID,state,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_5yr %>%
select(name, label),
by = c("name" = "name")
) %>%
select(-name) %>%
separate(
label,
into = c(NA, NA, "means"),
sep = "!!"
) %>%
pivot_wider(
means,
names_from = county,
values_from = estimate
) %>%
filter(!is.na(means)) %>%
mutate(
total = rowSums(.[,2:10])
) %>%
select(means, total)
View(bay_means)
ggplot(bay_means, aes(x=means, y=total)) +
geom_bar()
ggplot(bay_means, aes(x=means, y=total)) +
geom_bar()
ggplot(bay_means) +
geom_bar(aes(x=means, y=total), stat = "identity")
ggplot(bay_means) +
geom_bar(aes(x="", y=total, fill = means), stat = "identity")
ggplot(bay_means) +
geom_bar(aes(x="", y=total, fill = means), stat = "identity") +
coord_polar("y", start=0)
ggplot(bay_means) +
geom_bar(aes(x="", y=total, fill = means), stat = "identity") +
coord_polar("y", start=0)
bay_means <-
getCensus(
name = "acs/acs5",
vintage = 2019,
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = "group(B08105A)"
)
census_race_categories <-
c(
"White Alone",
"Black or African American",
"American Indian and Alaska Native Alone",
"Asian Alone",
"Native Hawaiian and Other Pacific Islander Alone",
"Some Other Race Alone",
"Two or More Races"
)
#A-G
census_race_categories <-
c(
"White Alone",
"Black or African American",
"American Indian and Alaska Native Alone",
"Asian Alone",
"Native Hawaiian and Other Pacific Islander Alone",
"Some Other Race Alone",
"Two or More Races"
)
bay_tp_race <-
1:7 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs5",
vintage = 2019,
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = paste0("group(B08105", LETTERS[x], ")")
) %>%
select(!c(GEO_ID,state,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_5yr %>%
select(name, label),
by = c("name" = "name")
) %>%
select(-name) %>%
separate(
label,
into = c(NA, NA, "means"),
sep = "!!"
)
})
View(bay_tp_race)
#A-G
census_race_categories <-
c(
"White Alone",
"Black or African American",
"American Indian and Alaska Native Alone",
"Asian Alone",
"Native Hawaiian and Other Pacific Islander Alone",
"Some Other Race Alone",
"Two or More Races"
)
bay_tp_race <-
1:7 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs5",
vintage = 2019,
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = paste0("group(B08105", LETTERS[x], ")")
) %>%
select(!c(GEO_ID,state,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_5yr %>%
select(name, label),
by = c("name" = "name")
) %>%
select(-name) %>%
separate(
label,
into = c(NA, NA, "means"),
sep = "!!"
) %>%
pivot_wider(
means,
names_from = county,
values_from = estimate
) %>%
filter(!is.na(means)) %>%
mutate(
total = rowSums(.[,2:10])
) %>%
select(means, total)
})
View(bay_tp_race)
#A-G
census_race_categories <-
c(
"White Alone",
"Black or African American",
"American Indian and Alaska Native Alone",
"Asian Alone",
"Native Hawaiian and Other Pacific Islander Alone",
"Some Other Race Alone",
"Two or More Races"
)
bay_tp_race <-
1:7 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs5",
vintage = 2019,
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = paste0("group(B08105", LETTERS[x], ")")
) %>%
select(!c(GEO_ID,state,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_5yr %>%
select(name, label),
by = c("name" = "name")
) %>%
select(-name) %>%
separate(
label,
into = c(NA, NA, "means"),
sep = "!!"
) %>%
pivot_wider(
means,
names_from = county,
values_from = estimate
) %>%
filter(!is.na(means)) %>%
mutate(
race = census_race_categories[x],
total = rowSums(.[,2:10])
) %>%
select(means, total, race)
})
View(bay_tp_race)
bay_tp_race <- bay_tp_race%>%
pivot_wider(
race,
names_from = means,
values_from = total
)
View(bay_tp_race)
bay_means <-
getCensus(
name = "acs/acs5",
vintage = 2019,
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = "group(B08105A)"
) %>%
select(!c(GEO_ID,state,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_5yr %>%
select(name, label),
by = c("name" = "name")
) %>%
select(-name) %>%
separate(
label,
into = c(NA, NA, "means"),
sep = "!!"
) %>%
pivot_wider(
means,
names_from = county,
values_from = estimate
) %>%
filter(!is.na(means)) %>%
mutate(
total = rowSums(.[,2:10])
) %>%
select(means, total)
ggplot(bay_means) +
geom_bar(aes(x="", y=total, fill = means), stat = "identity") +
coord_polar("y", start=0)
View(bay_means)
bay_tp_race <-
1:7 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs5",
vintage = 2019,
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = paste0("group(B08105", LETTERS[x], ")")
) %>%
select(!c(GEO_ID,state,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_5yr %>%
select(name, label),
by = c("name" = "name")
) %>%
select(-name) %>%
separate(
label,
into = c(NA, NA, "means"),
sep = "!!"
) %>%
pivot_wider(
means,
names_from = county,
values_from = estimate
) %>%
filter(!is.na(means)) %>%
mutate(
race = census_race_categories[x],
total = rowSums(.[,2:10])
) %>%
select(means, total, race)
})
View(bay_tp_race)
write_rds(bay_tp_race, "bay_tp_race.rds")
bay_tp_race <- readRDS("bay_tp_race.rds")
bay_tp_race <- readRDS("bay_tp_race.rds")
bay_tp_race %>%
group_by(means, race) %>%
summarize(estimate = sum(total)) %>%
ggplot() +
geom_bar(
aes(
x = means,
y = total,
fill = race
),
stat = "identity",
position = "stack"
) +
labs(
x = "Means of transportation",
y = "Number of population",
title = "Bay Area means of transportation by race",
fill = "Race of population"
)
bay_tp_race <- readRDS("bay_tp_race.rds")
bay_tp_race %>%
group_by(as.factor(means), race) %>%
summarize(estimate = sum(total)) %>%
ggplot() +
geom_bar(
aes(
x = means,
y = total,
fill = race
),
stat = "identity",
position = "stack"
) +
labs(
x = "Means of transportation",
y = "Number of population",
title = "Bay Area means of transportation by race",
fill = "Race of population"
)
bay_tp_race <- readRDS("bay_tp_race.rds")
bay_tp_race %>%
group_by(as.factor(means), race)
bay_tp_race %>%
group_by(as.factor(means), race) %>%
summarize(estimate = sum(total))
bay_tp_race %>%
group_by(as.factor(means), race) %>%
summarize(estimate = sum(total)) %>%
ggplot() +
geom_bar(
aes(
x = means,
y = total,
fill = race
),
stat = "identity",
position = "stack"
)
bay_tp_race %>%
group_by(means, race) %>%
summarize(estimate = sum(total)) %>%
ggplot() +
geom_bar(
aes(
x = means,
y = total,
fill = race
),
stat = "identity",
position = "stack"
)
bay_tp_race %>%
group_by(means, race)
View(bay_tp_race)
bay_tp_race %>%
group_by(means, race) %>%
summarize(total = sum(total)) %>%
ggplot() +
geom_bar(
aes(
x = means,
y = total,
fill = race
),
stat = "identity",
position = "stack"
)
bay_tp_race <- readRDS("bay_tp_race.rds")
bay_tp_race %>%
group_by(means, race) %>%
summarize(total = sum(total)) %>%
ggplot() +
geom_bar(
aes(
x = means,
y = total,
fill = race
),
stat = "identity",
position = "stack"
) +
labs(
x = "Means of transportation",
y = "Number of population",
title = "Bay Area means of transportation by race",
fill = "Race of population"
)
class(bay_tp_race$total)
bay_tp_race <- readRDS("bay_tp_race.rds")
bay_tp_race %>%
ggplot() +
geom_bar(
aes(
x = means,
y = total,
fill = race
),
stat = "identity",
position = "stack"
) +
labs(
x = "Means of transportation",
y = "Number of population",
title = "Bay Area means of transportation by race",
fill = "Race of population"
)
