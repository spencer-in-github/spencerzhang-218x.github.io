theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid  = element_blank())
bay_means = readRDS("bay_tp_means.rds")
ggplot(bay_means) +
geom_bar(aes(x="", y=total, fill = means), stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid  = element_blank()) +
labs(x = "", y = "Bay Area Population")
bay_means = readRDS("bay_tp_means.rds")
ggplot(bay_means) +
geom_bar(aes(x="", y=total, fill = means), stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid  = element_blank()) +
labs(x = "", y = "The Worker Population in the Bay Area")
bay_means = readRDS("bay_tp_means.rds")
ggplot(bay_means) +
geom_bar(aes(x="", y=total, fill = means), stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid  = element_blank()) +
labs(x = "", y = "The Worker Population in the Bay Area",
legend = "Means of commute")
bay_means = readRDS("bay_tp_means.rds")
ggplot(bay_means) +
geom_bar(aes(x="", y=total, fill = means), stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid  = element_blank()) +
labs(x = "", y = "The Worker Population in the Bay Area",
fill = "Means of commute")
bay_means = readRDS("bay_tp_means.rds")
ggplot(bay_means) +
geom_bar(aes(x="", y=total, fill = means), stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid  = element_blank()) +
labs(x = "", y = "The Worker Population in the Bay Area",
fill = "Means of Commute")
tp_by_race <-
1:7 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs5",
vintage = 2019,
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = paste0("group(B08105", LETTERS[x], ")")
) %>%
select(!c(GEO_ID,state,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_5yr %>%
select(name, label),
by = c("name" = "name")
) %>%
select(-name) %>%
separate(
label,
into = c(NA, NA, "means"),
sep = "!!"
) %>%
pivot_wider(
means,
names_from = county,
values_from = estimate
) %>%
filter(!is.na(means)) %>%
mutate(
race = census_race_categories[x],
total = rowSums(.[,2:10])
) %>%
select(means, total, race)
})
write_rds(tp_by_race, "tp_by_race.rds")
tp_by_race <- readRDS("tp_by_race.rds")
bay_means = readRDS("bay_tp_means.rds")
ggplot(bay_means) +
geom_bar(aes(x="", y=total, fill = means), stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid  = element_blank()) +
labs(x = "", y = "The Worker Population in the Bay Area",
fill = "Means of Commute",
title = "The Bay Area worker commute means composition")
bay_means = readRDS("bay_tp_means.rds")
ggplot(bay_means) +
geom_bar(aes(x="", y=total, fill = means), stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid  = element_blank()) +
labs(x = "", y = "The Worker Population in the Bay Area",
fill = "Means of Commute",
title = "The Bay Area worker commute means composition")
tp_by_residence = readRDS("tp_by_residence.rds")
tp_by_residence %>%
group_by(residence) %>%
summarise(estimate = sum(estimate)) %>%
ggplot() +
geom_bar(
aes(x="", y=estimate, fill = residence),
stat = "identity"
) +
coord_polar("y", start=0) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid  = element_blank()) +
labs(x = "",
y = "Bay Area Population",
title = "Bay Area Worker Composition by Work Place",
fill = "Place of residence")
bay_means = readRDS("bay_tp_means.rds")
ggplot(bay_means) +
geom_bar(aes(x="", y=total, fill = means), stat = "identity") +
coord_polar("y", start=0) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid  = element_blank()) +
labs(x = "", y = "The Worker Population in the Bay Area",
fill = "Means of Commute",
title = "The Bay Area worker commute means composition")
tp_by_residence = readRDS("tp_by_residence.rds")
tp_by_residence %>%
group_by(residence) %>%
summarise(estimate = sum(estimate)) %>%
ggplot() +
geom_bar(
aes(x="", y=estimate, fill = residence),
stat = "identity"
) +
coord_polar("y", start=0) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid  = element_blank()) +
labs(x = "",
y = "Bay Area Population",
title = "Bay Area Worker Composition by Work Place",
fill = "Place of residence")
tp_by_residence %>%
ggplot() +
geom_bar(
aes(
x = means %>% factor(levels = rev(unique(tp_by_residence$means))),
y = estimate,
fill = residence %>% factor(levels = rev(unique(tp_by_residence$residence)))
),
stat = "identity",
position = "fill"
) +
labs(
x = "Means of transportation",
y = "Number of population",
title = "Bay Area means of transportation by industry",
fill = "Work/Residence situation"
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
) +
guides(fill = guide_legend(reverse = T))
?bookdown::html_document2
devtools::install_github("nwstephens/rmdcss")
tp_by_residence %>%
ggplot() +
geom_bar(
aes(
x = means %>% factor(levels = rev(unique(tp_by_residence$means))),
y = estimate,
fill = residence %>% factor(levels = rev(unique(tp_by_residence$residence)))
),
stat = "identity",
position = "fill"
) +
labs(
x = "Means of transportation",
y = "Number of population",
title = "Bay Area means of transportation by industry",
fill = "Work/Residence situation"
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
) +
guides(fill = guide_legend(reverse = T))
tp_by_residence %>%
ggplot() +
geom_bar(
aes(
x = means %>% factor(levels = rev(unique(tp_by_residence$means))),
y = estimate,
fill = residence %>% factor(levels = rev(unique(tp_by_residence$residence)))
),
stat = "identity",
position = "fill"
) +
labs(
x = "Means of transportation",
y = "Number of population",
title = "Bay Area means of transportation by industry",
fill = "Work/Residence situation"
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
) +
guides(fill = guide_legend(reverse = T))
tp_by_residence %>%
ggplot() +
geom_bar(
aes(
x = means %>% factor(levels = rev(unique(tp_by_residence$means))),
y = estimate,
fill = residence %>% factor(levels = rev(unique(tp_by_residence$residence)))
),
stat = "identity",
position = "fill"
) +
labs(
x = "Means of transportation",
y = "Number of population",
title = "The Bay Area means of transportation by industry",
fill = "Work/Residence situation"
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
) +
guides(fill = guide_legend(reverse = T))
tp_by_residence %>%
ggplot() +
geom_bar(
aes(
x = means %>% factor(levels = rev(unique(tp_by_residence$means))),
y = estimate,
fill = residence %>% factor(levels = rev(unique(tp_by_residence$residence)))
),
stat = "identity",
position = "fill"
) +
labs(
x = "Means of transportation",
y = "Number of population",
title = "The Bay Area means of transportation by industry",
fill = "Work/Residence situation"
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
) +
guides(fill = guide_legend(reverse = T))
?theme
tp_by_residence %>%
ggplot() +
geom_bar(
aes(
x = means %>% factor(levels = rev(unique(tp_by_residence$means))),
y = estimate,
fill = residence %>% factor(levels = rev(unique(tp_by_residence$residence)))
),
stat = "identity",
position = "fill"
) +
labs(
x = "Means of transportation",
y = "Number of population",
title = "The Bay Area means of transportation by industry",
fill = "Work/Residence situation"
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical",
axis.line.x.bottom = T
) +
guides(fill = guide_legend(reverse = T))
tp_by_residence %>%
ggplot() +
geom_bar(
aes(
x = means %>% factor(levels = rev(unique(tp_by_residence$means))),
y = estimate,
fill = residence %>% factor(levels = rev(unique(tp_by_residence$residence)))
),
stat = "identity",
position = "fill"
) +
labs(
x = "Means of transportation",
y = "Number of population",
title = "The Bay Area means of transportation by industry",
fill = "Work/Residence situation"
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical",
axis.line.x.bottom = "bottom"
) +
guides(fill = guide_legend(reverse = T))
tp_by_residence %>%
ggplot() +
geom_bar(
aes(
x = means %>% factor(levels = rev(unique(tp_by_residence$means))),
y = estimate,
fill = residence %>% factor(levels = rev(unique(tp_by_residence$residence)))
),
stat = "identity",
position = "fill"
) +
labs(
x = "Means of transportation",
y = "Number of population",
title = "The Bay Area means of transportation by industry",
fill = "Work/Residence situation"
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
) +
guides(fill = guide_legend(reverse = T))
tp_by_residence %>%
ggplot() +
geom_bar(
aes(
x = means %>% factor(levels = rev(unique(tp_by_residence$means))),
y = estimate,
fill = residence %>% factor(levels = rev(unique(tp_by_residence$residence)))
),
stat = "identity",
position = "fill"
) +
labs(
x = "Means of transportation",
y = "Number of population",
title = "The Bay Area means of transportation by industry",
fill = "Work/Residence situation"
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
) +
guides(fill = guide_legend(reverse = T))
tp_by_residence %>%
ggplot() +
geom_bar(
aes(
x = means %>% factor(levels = rev(unique(tp_by_residence$means))),
y = estimate,
fill = residence %>% factor(levels = rev(unique(tp_by_residence$residence)))
),
stat = "identity",
position = "fill"
) +
labs(
x = "Means of transportation",
y = "Number of population",
title = "The Bay Area means of transportation by industry",
fill = "Work/Residence situation"
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
) +
guides(fill = guide_legend(reverse = T))
tp_by_race <- readRDS("tp_by_race.rds")
tp_by_race %>%
ggplot() +
geom_bar(
aes(
x = race %>% factor(levels = rev(unique(tp_by_race$race))),
y = total,
fill = means %>% factor(levels = rev(unique(tp_by_race$means)))
),
stat = "identity",
position = "fill"
) +
labs(
x = "Race of population",
y = "Number of population",
title = "Bay Area means of transportation by race",
fill = "Means of transportation"
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
) +
guides(fill = guide_legend(reverse = T))
tp_by_income <-
getCensus(
name = "acs/acs5",
vintage = 2019,
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = "group(B08119)"
) %>%
select(!c(GEO_ID,state,NAME) & !ends_with(c("EA","MA","M")) &!starts_with("B08119_00")) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_5yr %>%
select(name, label),
by = c("name" = "name")
) %>%
select(-name) %>%
separate(
label,
into = c(NA, NA, "means", "income"),
sep = "!!"
) %>%
select(-county) %>%
filter(!is.na(income)) %>%
group_by(means, income) %>%
summarise(estimate = sum(estimate))
saveRDS(tp_by_income,"tp_by_income.rds")
tp_by_income <- readRDS("tp_by_income.rds")
tp_by_income %>%
ggplot() +
geom_bar(
aes(
x = income %>% factor(levels = rev(unique(tp_by_income$income))),
y = estimate,
fill = means %>% factor(levels = rev(unique(tp_by_income$means)))
),
stat = "identity",
position = "fill"
) +
labs(
x = "Income",
y = "Number of population",
title = "Bay Area means of transportation by income",
fill = "Means of transportation"
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
) +
guides(fill = guide_legend(reverse = T))
tp_by_income <- readRDS("tp_by_income.rds")
tp_by_income %>%
ggplot() +
geom_bar(
aes(
x = income %>% factor(levels = rev(unique(tp_by_income$income))),
y = estimate,
fill = means %>% factor(levels = rev(unique(tp_by_income$means)))
),
stat = "identity",
position = "fill"
) +
labs(
x = "Income",
y = "Number of population",
title = "Bay Area means of transportation by income",
fill = "Means of transportation"
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
) +
guides(fill = guide_legend(reverse = T))
tp_by_industry = readRDS("tp_by_industry.rds")
tp_by_industry %>%
ggplot() +
geom_bar(
aes(
x = means %>% factor(levels = rev(unique(tp_by_industry$means))),
y = estimate,
fill = industry %>% factor(levels = rev(unique(tp_by_industry$industry)))
),
stat = "identity",
position = "fill"
) +
labs(
x = "Means of transportation",
y = "Number of population",
title = "Bay Area means of transportation by industry",
fill = "Industry"
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
) +
guides(fill = guide_legend(reverse = T))
